using UnityEngine;
using System;
// ???? ??? ?? ?????? ?? ??? ??
//?? ??? ?????, ?? ??, ?? ???? ??
public class LivingEntity : MonoBehaviour, IDamageable
{
    public float startingHealth = 100f; // ?? ??
    public float health { get; protected set; } // ?? ??
    public bool dead { get; protected set; } // ?? ??

    public event Action onDeath; // ?? ???
    
    //???? ??? ? ? ??? ??
    protected virtual void OnEnable()
    {
        dead = false; // ?? ?? ???
        health = startingHealth; // ?? ???
    }

    // ???? ????
    public virtual void OnDamage(float damage, Vector3 hitPoint, Vector3 hitNormal)
    {
        if (dead) return; // ?? ??? ?? ??? ??
        health -= damage; // ?? ??
        if (health <= 0f && !dead)
        {
            Die(); // ?? ??
        }
    }

    //??? ???? ??
    public virtual void RestoreHealth(float newHealth)
    {
        if (dead) return; // ?? ??? ?? ?? ??

        if (startingHealth <= health + newHealth) // ?? ???? ? ??
        {
            newHealth = startingHealth - health; // ?? ???? ??
        }

        //if (startingHealth <= health + newHealth) 
        //{
        //    health = startingHealth; 
        //}

        health += newHealth; // ?? ??
   
    }

    //????
    public virtual void Die()
    {
        //onDeath ???? ??? ???? ??? ??
        if (onDeath != null)
        {
            onDeath(); // ?? ??? ??
        }
        dead = true; // ?? ??? ??
    }
}


